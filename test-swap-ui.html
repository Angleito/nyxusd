<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Swap Detection</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .container {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
        }
        input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: #333;
            color: #fff;
            border: 1px solid #555;
            border-radius: 5px;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #1a1a1a;
            border-radius: 5px;
            white-space: pre-wrap;
        }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Debug Swap Detection</h1>
        
        <input type="text" id="testInput" placeholder="Enter swap message..." value="I want to swap tokens aero and eth">
        <button onclick="testDetection()">Test Detection</button>
        
        <div id="result" class="result"></div>
    </div>

    <script>
        // Simplified version of swapDetectionService
        class SwapDetectionService {
            detectSwapIntent(message) {
                const lowerMessage = message.toLowerCase();
                
                // Check for swap keywords
                const swapKeywords = ['swap', 'exchange', 'convert', 'trade', 'buy', 'sell', 'change', 'switch'];
                const hasSwapKeyword = swapKeywords.some(keyword => lowerMessage.includes(keyword));
                
                if (!hasSwapKeyword) {
                    return { isSwapIntent: false, confidence: 0 };
                }

                // Extract tokens
                const result = this.extractSwapParameters(message);
                
                // Calculate confidence
                let confidence = 0.5;
                if (result.inputToken) confidence += 0.15;
                if (result.outputToken) confidence += 0.15;
                if (result.amount) confidence += 0.2;
                
                return {
                    isSwapIntent: true,
                    confidence,
                    ...result
                };
            }

            extractSwapParameters(message) {
                const result = {};
                
                // Updated pattern that handles "swap tokens X and Y"
                const patterns = [
                    // "I want to swap tokens AERO and ETH" or "swap tokens X and Y"
                    /(?:want\s+to\s+)?swap\s+(?:tokens\s+)?(\w+)\s+(?:and|for|to|with)\s+(\w+)/i,
                    // Other patterns...
                    /swap\s+(\w+)\s+(?:for|to|into)\s+(\w+)/i,
                ];

                for (const pattern of patterns) {
                    const match = message.match(pattern);
                    if (match) {
                        result.inputToken = match[1].toUpperCase();
                        result.outputToken = match[2].toUpperCase();
                        break;
                    }
                }

                return result;
            }
        }

        const service = new SwapDetectionService();

        function testDetection() {
            const input = document.getElementById('testInput').value;
            const result = service.detectSwapIntent(input);
            
            const resultDiv = document.getElementById('result');
            let output = `Input: "${input}"\n\n`;
            output += `Detection Result:\n`;
            output += JSON.stringify(result, null, 2);
            
            if (result.isSwapIntent && result.inputToken && result.outputToken) {
                output += `\n\n‚úÖ Detected: ${result.inputToken} ‚Üí ${result.outputToken}`;
                resultDiv.className = 'result success';
            } else {
                output += `\n\n‚ùå Failed to detect swap properly`;
                resultDiv.className = 'result error';
            }
            
            resultDiv.textContent = output;
        }

        // Auto-test on load
        window.onload = testDetection;
    </script>
</body>
</html>